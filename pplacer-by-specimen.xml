<tool id="PHYLO_pplacer_by_specimen" name="Preprocess and place sequences" version="1.0.0" force_history_refresh="True">
  <description>on a reference tree (by specimen)</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <version_command>echo "guppy $(/home/matsengrp/local/bin/guppy --version), pplacer $(/home/matsengrp/local/bin/pplacer --version)"</version_command>
  <command interpreter="bash">
    pplacer-by-specimen-wrapper.sh ${config}
  </command>
  <stdio>
    <expand macro="basic_errors"/>
  </stdio>
  <inputs>
    <param name="refpkg" type="data" format="refpkg" label="Reference package"/>
    <param name="input_seqs" type="data" format="fasta" label="Input sequences"/>
    <param name="split_map" type="data" format="csv" label="Read-to-specimen map"/>
  </inputs>
  <outputs>
    <data name="dedup_info" format="csv" label="Deduplication info"/>
    <data name="placed_seqs" format="jplace" label="Placed sequences"/>
  </outputs>
  <configfiles>
    <configfile name="config">
REFPKG="${refpkg.extra_files_path}"
INPUT_SEQS="${input_seqs}"
SPLIT_MAP="${split_map}"

DEDUP_INFO="${dedup_info}"
PLACED_SEQS="${placed_seqs}"
    </configfile>
  </configfiles>
  <!-- The contents of the help tag is parsed as reStructuredText. Please see
       help-template.rst for examples of commonly-used sections in other Galaxy
       tools. -->
  <help>

.. class:: infomark

**What it does**

This tool aligns query sequences with the reference sequences used to make the
reference tree contained in the reference package and then merges the query and
reference sequences. It then places query sequences on a fixed reference
phylogenetic tree according to a reference alignment, producing taxonomic
annotations which can be used for classification and visualization.

-----

**Citation**

Matsen F, Kodner R, Armbrust E V: **pplacer: linear time maximum-likelihood and
Bayesian phylogenetic placement of sequences onto a fixed reference tree**. BMC
Bioinformatics 2010, **11**:1.

  </help>
</tool>
